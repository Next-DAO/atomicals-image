'use strict';
var chai = require('chai');
var expect = require('chai').expect;
var chaiAsPromised = require('chai-as-promised');
chai.use(chaiAsPromised);
var index = require('../../dist/index.js');

describe('atomical-format-helpers test', () => {
   it('success decode mint tx', async () => {
      const rawtx = '010000000001011312da9067f369d38395b5dc4c7341216493dcb059028a824d62b21f701aefbd0000000000ffffffff012202000000000000225120a92594bbe38b023dd3a4c97d57efe63bb67a2bf130dd96e1cdd2e99ddd223b410340e2ad19d648ab38f7b3086c219dc2b293d6951a6f12b4fa45b05d009fb8ceac61540ea1a7f8a527e42ca0d50e69ebd3ac7199c2e53ee96a73aee81ed0c798583afd570120b038e3ce658cbfa82fb61975891a82706d81e1e17cde7e429767a84dd9824056ac00630473707232016d4d2801a17473616d706c652d6d616e69666573742e6a736f6ea2626374781f6170706c69636174696f6e2f6a736f6e3b20636861727365743d7574662d38616458e97b0a202020202276657273696f6e223a2022302e302e31222c0a202020202273616d706c65223a207b0a202020202020202022666f6f223a2022626172222c0a20202020202020202262617a2d313233223a20393138322e34320a202020207d2c0a20202020226e6573746564223a205b0a20202020202020207b0a20202020202020202020202022736f6d65223a207b0a20202020202020202020202020202020226f74686572223a205b20312c202261222c207b2022616c696365223a2022626f6220227d205d0a2020202020202020202020207d0a20202020202020207d0a202020205d0a7d6821c0b038e3ce658cbfa82fb61975891a82706d81e1e17cde7e429767a84dd982405600000000';
      const fileMap = index.buildAtomicalsFileMapFromRawTx(rawtx);
      const hexified = index.hexifyObjectWithUtf8(fileMap, false);
      expect(hexified).to.eql({
         "0": {
            "opType": "m",
            "rawdata": "a17473616d706c652d6d616e69666573742e6a736f6ea2626374781f6170706c69636174696f6e2f6a736f6e3b20636861727365743d7574662d38616458e97b0a202020202276657273696f6e223a2022302e302e31222c0a202020202273616d706c65223a207b0a202020202020202022666f6f223a2022626172222c0a20202020202020202262617a2d313233223a20393138322e34320a202020207d2c0a20202020226e6573746564223a205b0a20202020202020207b0a20202020202020202020202022736f6d65223a207b0a20202020202020202020202020202020226f74686572223a205b20312c202261222c207b2022616c696365223a2022626f6220227d205d0a2020202020202020202020207d0a20202020202020207d0a202020205d0a7d",
            "decoded": {
               "sample-manifest.json": {
                  "ct": "application/json; charset=utf-8",
                  "d": "7b0a202020202276657273696f6e223a2022302e302e31222c0a202020202273616d706c65223a207b0a202020202020202022666f6f223a2022626172222c0a20202020202020202262617a2d313233223a20393138322e34320a202020207d2c0a20202020226e6573746564223a205b0a20202020202020207b0a20202020202020202020202022736f6d65223a207b0a20202020202020202020202020202020226f74686572223a205b20312c202261222c207b2022616c696365223a2022626f6220227d205d0a2020202020202020202020207d0a20202020202020207d0a202020205d0a7d"
               }
            }
         }
      })
   });

});
